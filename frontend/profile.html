<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SkillSync | Profile</title>
<link rel="stylesheet" href="./output.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body class="bg-gray-100 dark:bg-gray-900 min-h-screen flex justify-center items-center">

<div class="w-[650px] bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl">

<h1 class="text-3xl font-bold text-gray-900 dark:text-white text-center mb-4">
ðŸ‘¤ Profile Settings
</h1>

<p class="text-center text-gray-500 dark:text-gray-400 mb-6">
View & update your SkillSync account details
</p>

<!-- PROFILE CARD -->
<div class="space-y-4">

<!-- EMAIL (READ ONLY) -->
<div>
<label class="text-gray-700 dark:text-gray-300 font-semibold">
Email (Not Editable)
</label>
<input id="emailBox"
class="w-full p-3 rounded-lg bg-gray-300 dark:bg-gray-700 dark:text-white"
disabled />
</div>

<!-- USERNAME -->
<div>
<label class="text-gray-700 dark:text-gray-300 font-semibold">
Full Name
</label>
<input id="nameBox"
placeholder="Enter your name..."
class="w-full p-3 rounded-lg bg-gray-200 dark:bg-gray-700 dark:text-white" />
</div>

<!-- HEADLINE -->
<div>
<label class="text-gray-700 dark:text-gray-300 font-semibold">
Headline / About (Ex: Aspiring AI Engineer, Python Developerâ€¦)
</label>
<textarea id="headlineBox"
placeholder="Write something about yourself..."
class="w-full h-24 p-3 rounded-lg bg-gray-200 dark:bg-gray-700 dark:text-white"></textarea>
</div>

<button id="saveBtn"
class="w-full bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-lg mt-4">
Save Profile
</button>

<button id="backBtn"
class="w-full bg-gray-400 hover:bg-gray-500 text-white p-3 rounded-lg mt-2">
â¬… Back to Dashboard
</button>

</div>
</div>

<!-- FIREBASE -->
<script type="module">

import { auth, db } from "./firebase.js";
import { onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { doc, getDoc, setDoc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const emailBox = document.getElementById("emailBox");
const nameBox  = document.getElementById("nameBox");
const headlineBox = document.getElementById("headlineBox");
const saveBtn = document.getElementById("saveBtn");
const backBtn = document.getElementById("backBtn");

let currentUserId = null;

// Load Profile
onAuthStateChanged(auth, async(user)=>{
 if(!user){
   alert("Login First");
   window.location.href="login.html";
   return;
 }

 currentUserId = user.uid;
 emailBox.value = user.email;

 const ref = doc(db,"users",user.uid);
 const snap = await getDoc(ref);

 if(snap.exists()){
   const data = snap.data();
   nameBox.value = data.name || "";
   headlineBox.value = data.headline || "";
 }
});


// Save Profile
saveBtn.addEventListener("click", async()=>{

 if(nameBox.value.trim() === ""){
  alert("Name cannot be empty");
  return;
 }

 await setDoc(doc(db,"users",currentUserId),{
  email: emailBox.value,
  name: nameBox.value,
  headline: headlineBox.value
 }, { merge:true });

 alert("Profile Updated Successfully âœ…");
});


// Back to Dashboard
backBtn.onclick = ()=>{
 window.location.href="dashboard.html";
}

</script>

</body>
</html>
