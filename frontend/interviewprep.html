<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SkillSync | Interview Prep</title>
<link rel="stylesheet" href="./output.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body class="bg-gray-100 dark:bg-gray-900 min-h-screen flex justify-center items-center">

<div class="w-[700px] bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-2xl">

<h1 class="text-3xl font-bold text-gray-900 dark:text-white text-center mb-4">
ðŸŽ¯ AI Interview Prep Assistant
</h1>

<p class="text-center text-gray-500 dark:text-gray-400 mb-6">
Get unlimited technical + non-technical interview questions based on your resume & role
</p>

<label class="text-gray-700 dark:text-gray-300 font-semibold">Select Role</label>
<select id="roleSelect"
class="w-full p-3 rounded-lg bg-gray-200 dark:bg-gray-700 dark:text-white mb-3">
<option value="">-- Select Role --</option>
<option value="software developer">Software Developer</option>
<option value="data scientist">Data Scientist</option>
<option value="ai engineer">AI / ML Engineer</option>
<option value="frontend developer">Frontend Developer</option>
<option value="backend developer">Backend Developer</option>
<option value="full stack developer">Full Stack Developer</option>
<option value="business analyst">Business Analyst</option>
<option value="cloud engineer">Cloud Engineer</option>
<option value="devops engineer">DevOps Engineer</option>
<option value="custom">Custom Role</option>
</select>

<input id="customRole"
placeholder="Enter custom role"
class="hidden w-full p-3 rounded-lg bg-gray-200 dark:bg-gray-700 dark:text-white mb-3">

<label class="text-gray-700 dark:text-gray-300 font-semibold">
Paste Resume Text (Optional)
</label>

<textarea id="resumeBox"
placeholder="Paste resume text..."
class="w-full h-32 p-3 rounded-lg bg-gray-200 dark:bg-gray-700 dark:text-white mb-4"></textarea>

<button id="generateBtn"
class="w-full bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-lg mb-4">
Generate Questions
</button>

<h2 class="text-xl text-gray-900 dark:text-white font-semibold">
Interview Questions:
</h2>

<div id="questionsBox"
class="mt-4 space-y-4 text-gray-900 dark:text-white">
No questions generated yet...
</div>

<button id="moreBtn"
class="hidden w-full mt-4 bg-green-600 hover:bg-green-700 text-white p-3 rounded-lg">
Load More Questions
</button>

</div>

<script>
const roleSelect = document.getElementById("roleSelect");
const customRole = document.getElementById("customRole");
const questionsBox = document.getElementById("questionsBox");
const moreBtn = document.getElementById("moreBtn");

let resumeText = "";
let askedQuestions = new Set();

roleSelect.addEventListener("change", ()=>{
 if(roleSelect.value === "custom") customRole.classList.remove("hidden");
 else customRole.classList.add("hidden");
});

function toggleAnswer(id){
 document.getElementById(id).classList.toggle("hidden");
}

function render(list){
 questionsBox.innerHTML = "";

 list.forEach((q)=>{
  if(askedQuestions.has(q.question)) return;
  askedQuestions.add(q.question);

  const div = document.createElement("div");
  div.className = "p-4 rounded-lg bg-gray-100 dark:bg-gray-700";

  const id = "ans" + askedQuestions.size;

  div.innerHTML = `
  <p class="font-semibold">${askedQuestions.size}. ${q.question}</p>
  <p class="text-sm mt-1">
   Difficulty:
   <span class="text-indigo-400 font-semibold">${q.difficulty}</span> |
   Type:
   <span class="text-green-400 font-semibold">${q.type}</span>
  </p>

  <button onclick="toggleAnswer('${id}')"
  class="mt-2 px-3 py-1 bg-blue-500 text-white rounded-lg">
  Show Answer
  </button>

  <p id="${id}" class="hidden mt-2 text-yellow-300">
   ${q.answer}
  </p>
  `;

  questionsBox.appendChild(div);
 });
}

async function getQuestions(){
 let role = roleSelect.value;
 if(role === "custom") role = customRole.value;

 if(!role){
  alert("Select role or enter custom role");
  return;
 }

 resumeText = document.getElementById("resumeBox").value;

 const res = await fetch("http://localhost:5000/generate-interview", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    role: role,
    resume: resumeText,
    previousQuestions: Array.from(askedQuestions)
  })
});

 const result = await res.json();

 if(!result.success){
  alert("Server Error");
  return;
 }

 const tech = result.data.technical.map(q=>({...q,type:"Technical"}));
 const non = result.data.nonTechnical.map(q=>({...q,type:"Non Technical"}));

 render([...tech, ...non]);
 moreBtn.classList.remove("hidden");
}

document.getElementById("generateBtn").addEventListener("click",()=>{
 askedQuestions.clear();
 getQuestions();
});

moreBtn.addEventListener("click",()=> getQuestions());
</script>

</body>
</html>
