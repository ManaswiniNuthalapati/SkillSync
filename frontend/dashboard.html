<!DOCTYPE html>
<html lang="en" class="light">

<head>
<meta charset="UTF-8">
<title>SkillSync | Dashboard</title>
<link rel="stylesheet" href="./output.css">

<!-- Chart JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body class="bg-gray-50 dark:bg-gray-900 min-h-screen flex">

<!-- Sidebar -->
<aside id="sidebar"
class="w-64 bg-white dark:bg-gray-800 shadow-xl min-h-screen transition-all duration-300">

<div class="p-6">
<h2 class="text-2xl font-bold text-gray-900 dark:text-white">SkillSync</h2>
</div>

<nav class="px-4 space-y-2">
<a href="./dashboard.html" class="nav-item">ğŸ  Dashboard</a>
<a href="./resume.html" class="nav-item">ğŸ“š Resume Analyzer</a>
<a href="./interviewprep.html" class="nav-item">ğŸ“ˆ Interview Prep</a>
<a href="./profile.html" class="nav-item">ğŸ‘¤ Profile</a>
</nav>
</aside>


<section class="flex-1">

<header class="flex justify-between items-center px-8 py-4 bg-white dark:bg-gray-800 shadow">

<button id="toggleBtn"
class="text-2xl bg-gray-200 dark:bg-gray-700 px-3 py-1 rounded-lg dark:text-white">
â˜°
</button>

<div class="flex gap-3">
<button id="themeToggle"
class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-xl dark:text-white">
ğŸŒ™ Dark
</button>

<button id="logoutBtn"
class="px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600">
Logout
</button>
</div>

</header>

<main class="p-8">

<h1 class="text-3xl font-semibold text-gray-900 dark:text-white mb-3">
Dashboard Analytics
</h1>

<h2 id="welcomeText" class="text-lg text-gray-500 dark:text-gray-300 mb-6">
Loading...
</h2>


<!-- ANALYTICS -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

<!-- ATS GAUGE -->
<div class="card text-center">
<h3 class="text-lg font-bold text-gray-900 dark:text-white mb-2">
ğŸ“„ Resume ATS Strength
</h3>

<div class="flex justify-center">
<canvas id="atsGauge" width="160" height="160"></canvas>
</div>

<p id="atsText" class="mt-2 text-black dark:text-gray-200 text-sm">
Analyzing...
</p>
</div>


<!-- SKILLS BAR -->
<div class="card text-center">
<h3 class="text-lg font-bold text-gray-900 dark:text-white mb-2">
ğŸ§  Skill Strength Overview
</h3>

<div class="flex justify-center">
<canvas id="skillsBar" width="260" height="180"></canvas>
</div>

<p class="mt-2 text-black dark:text-gray-200 text-sm">
Top performing skills from resume ğŸ”¥
</p>
</div>

</div>

</main>
</section>



<!-- Sidebar + Theme -->
<script>
const sidebar=document.getElementById("sidebar");
document.getElementById("toggleBtn").onclick=()=>sidebar.classList.toggle("w-16");

const themeBtn=document.getElementById("themeToggle");
if(localStorage.getItem("theme")==="dark"){
 document.documentElement.classList.add("dark")
 themeBtn.innerText="â˜€ï¸ Light"
}
themeBtn.onclick=()=>{
 document.documentElement.classList.toggle("dark")
 if(document.documentElement.classList.contains("dark")){
  localStorage.setItem("theme","dark");
  themeBtn.innerText="â˜€ï¸ Light"
 }else{
  localStorage.setItem("theme","light");
  themeBtn.innerText="ğŸŒ™ Dark"
 }
}
</script>



<!-- Firebase + Analytics -->
<script type="module">
import { auth, db } from "./firebase.js";
import { onAuthStateChanged, signOut }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { doc, getDoc } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const welcomeText = document.getElementById("welcomeText");
const logoutBtn = document.getElementById("logoutBtn");

let atsScore = 0;
let skills = [];

onAuthStateChanged(auth, async (user)=>{
 if(!user){
  window.location.href="./login.html";
  return;
 }

 const ref = doc(db,"users",user.uid);
 const snap = await getDoc(ref);

 if(snap.exists()){
  welcomeText.innerText = `Welcome, ${snap.data().email} ğŸ‘‹`;

  atsScore = snap.data().atsScore || 60;

  skills = snap.data().skills || ["Resume", "Projects", "Communication"];
 }

 drawCharts();
});

logoutBtn.addEventListener("click", async ()=>{
 await signOut(auth);
 alert("Logged Out ğŸ‘‹");
 window.location.href="./login.html";
});


// -------- CHARTS --------
function drawCharts(){

// ATS GAUGE
new Chart(document.getElementById("atsGauge"),{
 type:"doughnut",
 data:{
  labels:["Score","Remaining"],
  datasets:[{
   data:[atsScore,100-atsScore],
   backgroundColor:["#22c55e","#d1d5db"]
  }]
 },
 options:{
  responsive:false,
  cutout:"75%",
  plugins:{legend:{display:false}}
 }
});
document.getElementById("atsText").innerText =
 `Your resume is ${atsScore}% ATS optimized`;


// SKILLS BAR
new Chart(document.getElementById("skillsBar"),{
 type:"bar",
 data:{
  labels:skills.slice(0,4),
  datasets:[{
   data:[90,75,60,50].slice(0,skills.length),
   backgroundColor:"#4f46e5"
  }]
 },
 options:{
  responsive:false,
  plugins:{legend:{display:false}},
  scales:{
   y:{suggestedMin:0,suggestedMax:100}
  }
 }
});
}
</script>



<!-- Styling -->
<style>
.nav-item{
 display:block;
 width:100%;
 padding:12px;
 border-radius:8px;
 color:#6b7280
}
.nav-item:hover{background:#e5e7eb;transform:translateX(3px)}
.dark .nav-item:hover{background:#374151;color:white}

.card{
 background:white;
 padding:18px;
 border-radius:18px;
 box-shadow:0 10px 30px rgba(0,0,0,.08)
}
.dark .card{background:#1f2937}
</style>

</body>
</html>
